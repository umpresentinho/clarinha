
        const QUOTES = [
            "Dizem que um homem só se apaixona uma única vez, isso de fato é uma mentira, pois me apaixonei no brilho de seus olhos, no teu mais belo sorriso, e em tua mais doce voz.",
            "Você é tão linda que a lua e o sol se revezam para contemplar sua beleza.",
            "Você é a resposta de todas as minhas orações",
            "Existem 7.000 idiomas, 650.000 palavras no mundo e, no entanto, toda vez que vejo você, ainda fico totalmente sem palavras.",
            "Eu só pensei que havia dois tipos de amor, aquele pelo qual você mataria e aquele pelo qual você morreria, mas ver você me fez perceber que você era o tipo de amor pelo qual eu viveria.",
            "Toda vez que desvio o olhar de você, me encontro procurando por você.",
            "Se eu pudesse mudar as coisas, mudaria a lua para seus olhos e o sol para seu sorriso, então me deitaria com seu olhar e me levantaria com seu sorriso.",
            "Eles podem dizer que você é o Sol que ilumina tudo em seu caminho, mas para mim você é a Lua, que ilumina a escuridão nos momentos mais carentes.",
            "Seus olhos ganhariam um espaço no céu, pois eles brilham mais do que as próprias estrelas.",
            "A lua é a beleza de Deus, o sol é o poder de Deus e você é sua mais bela criação.",
            "Quando o sol nasce, você não tem sombra, porque não há nada que possa replicar sua beleza.",
            "Seus olhos são como nuvens, pois mesmo quando eles enchem de tristeza e afogam a terra, eles pintam o céu com uma beleza inimaginável.",
            "Existem incontáveis estrelas no universo, mas a única que me encanta com seu brilho só pode ser encontrada na vastidão dos seus olhos.",
            "Espero que, com cada oração sussurrada, algum dia, em breve, nossos caminhos na verdade sejam compartilhados. Até então, meu amor, em sonhos eu vou te abraçar e valorizar cada momento, mesmo que eles desapareçam.",
            "Tenho conversas noturnas com a lua, ela me fala do sol e eu falo de você.",
            "O elogio mais belo e profundo nunca será suficiente pra você, pois sua beleza ultrapassa todos os meios de pronúncia.",
            "Se você carregasse a maldição da Medusa, eu ainda olharia para seus olhos para que meu corpo de pedra pudesse contemplar a perfeição para a eternidade.",
            "Sua beleza me surpreende pois ao colocar meus olhos em você é como receber uma recompensa não destinada a mim ou a qualquer outra pessoa.",
            "Eu já presenciei a gloriosa luz de mil sóis, isso foi o suficiente para eu perceber que somente a sua presença faz com que todas aquelas luzes tornem apenas mais algumas partículas de fótons, comparado ao brilho de teu olhar.",
            "Eu observei as estrelas por horas entediado, mas quando olhei em seus olhos nem pude ver o tempo passar, tudo parou, exceto o meu encanto por você.",
            "Eu caminharia no mesmo deserto, passaria pelo mesmo pântano, nadaria nos mesmos mares se me falassem que no fim do caminho, eu te encontraria.",
            "Se eu pudesse pedir para Deus refazer o universo, pediria para Ele substituir você pela lua entre as estrelas, então eu poderia olhar para você todas as noites.",
            "Se você for o sol, eu serei Ícaro, um tolo fadado a cair e queimar antes mesmo de chegar até você. Mesmo em asas de cera, eu voaria em sua direção.",
            "Deus nos deu dois ouvidos, dois olhos, duas pernas e duas mãos, mas Ele só nos deu um coração, e Ele queria que eu te encontrasse e te dissesse, você é o segundo.",
            "Seus olhos são como um labirinto, quando olho para eles me perco, descubro que não quero sair daquele labirinto.",
            "Se eu ficasse cego no momento em que colocasse meus olhos em você, eu não lamentaria, pois naquele momento eu já tinha visto toda a beleza que este mundo tinha para mostrar.",
            "Os girassóis devem se voltar para você, pois confundem sua beleza brilhante com o sol.",
            "Há tantas estrelas no céu noturno, mas há uma que brilha e faisca mais, como aquela vez em que te vi brilhando e brilhando na multidão.",
            "Não vejo por que os astronautas vão ao espaço para que possam ver o mundo, vejo o meu só de olhar para você.",
            "As estrelas tinham tanta inveja de como você era brilhante que forçaram o sol a cair para sua morte apenas para serem vistas, mas você as ofuscou todas as vezes.",
            "Meus sonhos se transformam em pesadelos no momento em que acordo, mas você na minha frente me faz pensar se estou sempre sonhando.",
            "Um dia lembro-me de sentir meu coração cair e congelar atordoado com a obra-prima de Deus. Percebi que estava olhando para você.",
            "Van Gogh teria tido inveja de mim, porque ele pintou a noite estrelada apenas uma vez, e eu consigo ver as mais belas estrelas somente olhando em teus olhos.",
            "Assim como a noite é estrelada, você possui uma imensidão de estrelas no olhar. Você é admirável como os girassóis. Van Gogh ficaria fascinado, pois você é a junção das suas belas obras.",
            "Pintores buscaram retratar a perfeição e não conseguiram, mas eu vejo o que tanto buscaram em seus olhos.",
            "Van Gogh não conseguiu fazer as mais belas estrelas, nem a mais bela constelação. Isso só aconteceu porque ele não conhecia a existência dos seus olhos.",
            "Descobri o motivo da tristeza do velho homem que Van Gogh retrata no quadro “Sorrowing Old Man”. O motivo de sua tristeza foi o fato de ele nunca poder admirar uma garota igual você.",
            "Van Gogh disse que a visão das estrelas o fazia sonhar, mas se ele visse as estrelas que eu vejo em seus olhos, ele nunca mais iria querer acordar.",
            "Van Gogh só conseguiu retratar o amarelo nos girassóis porque ele não viu o arco-íris que você transmite no seu olhar.",
            "Van Gogh só amou as estrelas porque ele não viu a constelação do seu olhar.",
            "Se você morrer, eu ficaria com inveja da terra que pode te abraçar por toda a eternidade.",
            "Eu queria ser uma de suas lágrimas, para poder nascer em seus olhos, escorrer pela sua bochecha e morrer em seus lábios.",
            "Se eu me atrevesse a gritar ao mundo o quanto eu te amo, eu simplesmente sussurraria isso em seus ouvidos. Pois o meu mundo é você.",
            "Dizem que as pessoas só podem estar em um lugar de cada vez, mas isso é errado, pois você está em minha mente e em meu coração ao mesmo tempo.",
            "Durante séculos, os humanos usaram as estrelas para guiá-los em suas jornadas. Mas toda vez que olho em seus olhos, me perco.",
            "Eu não te amo com meu coração ou mente. Eu te amo com minha alma, caso minha mente esqueça e meu coração pare.",
            "Se eu tivesse que esperar minha vida inteira para experimentar o seu amor, eu o faria. E morrendo após isso ficaria feliz, pois eu teria experimentado o céu antes mesmo de alcançá-lo.",
            "Mesmo em tempos que lembram preto e branco, você continua a brilhar como ouro para mim.",
            "Se eu tivesse uma flor para cada pensamento em você, eu poderia andar pelo meu jardim para a eternidade.",
            "Se eu fosse aprender todas as línguas do mundo, ainda não encontraria as palavras exatas para expressar o quanto te amo.",
            "Se eu tivesse que escolher entre o sol e a lua ou as estrelas, eu escolheria seus olhos como eles brilham mais do que todos eles.",
            "Se minha alma fosse uma caneta e meu coração tinta, com o sangue de minhas veias eu escreveria “eu te amo”.",
            "Os girassóis devem se voltar para você, pois confundem sua beleza brilhante com o sol.",
            "Por que eu olharia para outras estrelas quando já me apaixonei pela lua?",
            "Quando te conheci percebi que os anjos nunca nos convidariam, porque se vissem a perfeição com que Deus te criou, seu ciúme causaria guerra.",
            "Dizem que a Fossa das Marianas é o lugar mais profundo da terra, mas isso é falso, pois ela não se compara à profundidade do meu amor por você.",
            "Se o sol desaparecesse não faria diferença porque você brilha mais do que qualquer estrela do universo.",
            "Não importa o quão bonito seja o pôr do sol, nada pode comparar sua beleza, pois mesmo que o sol se ponha, seu brilho ainda iluminaria meu mundo.",
            "Se eu tivesse que escolher entre respirar e te amar, daria meu último suspiro para dizer que te amo.",
            "Dizem que a beleza está nos olhos de quem vê, mas com o jeito que você me balança com seu abraço caloroso, até os cegos podem imaginar sua beleza.",
            "Um dia você vai me perguntar quem é a vida mais importante, a sua ou a minha, ao que eu responderei a minha e você irá embora sem saber.",
            "Você roubou meu fôlego, minha atenção, meu coração e meus pensamentos, mas imploro que tire mais de mim, até mesmo meu sobrenome.",
            "Você não tem reflexo meu amor, porque nada neste mundo pode replicar a beleza divina que você possui."
        ];

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d', { alpha: false });
        const textOverlay = document.getElementById('text-overlay');
        const hud = document.getElementById('hud');
        const counterText = document.getElementById('counter-text');
        const mysteryHint = document.getElementById('mystery-hint');
        const bgMusic = document.getElementById('bg-music');
        const finaleMusic = document.getElementById('finale-music');
        const starSFX = document.getElementById('star-sfx');
        const toggleMusicBtn = document.getElementById('toggle-music');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const equalizer = document.getElementById('equalizer');
        const musicPlayer = document.getElementById('music-player');
        const introOverlay = document.getElementById('intro-overlay');
        const startBtn = document.getElementById('start-btn');

        bgMusic.volume = 0.1;
        finaleMusic.volume = 0;
        starSFX.volume = 0.3;

        let width, height;
        let zoom = 0.01; 
        let targetZoom = 0.01; 
        let panX = 0, panY = 0, targetPanX = 0, targetPanY = 0;
        let isDragging = false, lastMouseX = 0, lastMouseY = 0;
        let initialPinchDistance = null, initialZoom = null;

        const constellations = [];
        const shootingStars = [];
        const SPREAD = 12000;
        let discoveredCount = 0;
        let totalConstellations = 0;
        let isFinaleActive = false;
        let finaleStartTime = 0;
        let lastDiscoveryTime = Date.now();
        let currentHintIndex = -1;
        const HINT_DELAY = 12000;
        let gameStarted = false;

        function seededRandom(seed) {
            const x = Math.sin(seed++) * 10000;
            return x - Math.floor(x);
        }

        class Constellation {
            constructor(quote, id, type = 'normal') {
                this.quote = quote;
                this.id = id;
                this.type = type; 
                this.isDiscovered = false;
                this.isHinted = false;
                
                if (type === 'sun') {
                    this.worldX = 2200; this.worldY = -1800;
                } else if (type === 'moon') {
                    this.worldX = -2500; this.worldY = 2200;
                } else {
                    const r1 = seededRandom(id * 456);
                    const r2 = seededRandom(id * 654);
                    this.worldX = (r1 - 0.5) * SPREAD;
                    this.worldY = (r2 - 0.5) * SPREAD;
                }

                this.targetFinaleX = 0;
                this.targetFinaleY = 0;

                this.stars = [];
                const count = type !== 'normal' ? 1 : (3 + Math.floor(seededRandom(id) * 5));
                for(let i=0; i<count; i++) {
                    const angle = seededRandom(id + i) * Math.PI * 2;
                    const dist = 30 + seededRandom(id + i * 10) * 80;
                    this.stars.push({
                        dx: i === 0 ? 0 : Math.cos(angle) * dist,
                        dy: i === 0 ? 0 : Math.sin(angle) * dist,
                        size: type === 'sun' ? 65 : (type === 'moon' ? 55 : 1.5 + seededRandom(id + i) * 2),
                        pulse: seededRandom(id + i) * Math.PI * 2,
                    });
                }

                this.el = document.createElement('div');
                this.el.className = 'quote-label';
                if (type === 'sun') {
                    this.el.innerHTML = `<span class="celestial-title"></span>${quote}`;
                    this.el.style.color = "#fbbf24";
                } else if (type === 'moon') {
                    this.el.innerHTML = `<span class="celestial-title"></span>${quote}`;
                    this.el.style.color = "#cbd5e1";
                } else {
                    this.el.textContent = quote;
                }
                textOverlay.appendChild(this.el);
            }

            draw(ctx, currentZoom, currentPanX, currentPanY) {
                const screenX = width / 2 + (this.worldX + currentPanX) * currentZoom;
                const screenY = height / 2 + (this.worldY + currentPanY) * currentZoom;

                if (!gameStarted && !isFinaleActive) return;

                if (!isFinaleActive) {
                    const margin = 400 * currentZoom;
                    if (screenX < -margin || screenX > width + margin || screenY < -margin || screenY > height + margin) {
                        if (this.el.classList.contains('visible')) this.el.classList.remove('visible');
                        return;
                    }
                }

                const dx = screenX - width / 2;
                const dy = screenY - height / 2;
                const distToCenter = Math.sqrt(dx*dx + dy*dy);
                const isCentered = distToCenter < 180;
                
                if (this.isDiscovered || this.isHinted) {
                    ctx.beginPath();
                    ctx.strokeStyle = this.isDiscovered ? 'rgba(186, 230, 253, 0.3)' : 'rgba(251, 191, 36, 0.3)';
                    ctx.lineWidth = 1 * currentZoom;
                    this.stars.forEach((s, i) => {
                        const sx = screenX + s.dx * currentZoom;
                        const sy = screenY + s.dy * currentZoom;
                        if (i === 0) ctx.moveTo(sx, sy);
                        else ctx.lineTo(sx, sy);
                    });
                    ctx.stroke();
                }

                this.stars.forEach((s) => {
                    const sx = screenX + s.dx * currentZoom;
                    const sy = screenY + s.dy * currentZoom;
                    
                    s.pulse += 0.03;
                    const pulseScale = 1 + Math.sin(s.pulse) * 0.25;
                    const size = s.size * Math.max(currentZoom, 0.3) * pulseScale;
                    
                    ctx.beginPath();
                    if (this.type === 'sun') {
                        const grad = ctx.createRadialGradient(sx, sy, 0, sx, sy, size*2.5);
                        grad.addColorStop(0, 'rgba(251, 191, 36, 1)');
                        grad.addColorStop(0.2, 'rgba(251, 191, 36, 0.8)');
                        grad.addColorStop(1, 'transparent');
                        ctx.fillStyle = grad;
                    } else if (this.type === 'moon') {
                        const grad = ctx.createRadialGradient(sx, sy, 0, sx, sy, size*2);
                        grad.addColorStop(0, 'rgba(203, 213, 225, 1)');
                        grad.addColorStop(0.3, 'rgba(203, 213, 225, 0.7)');
                        grad.addColorStop(1, 'transparent');
                        ctx.fillStyle = grad;
                    } else {
                        ctx.fillStyle = this.isDiscovered ? '#bae6fd' : 'rgba(255, 255, 255, 0.8)';
                    }
                    
                    ctx.arc(sx, sy, size, 0, Math.PI * 2);
                    ctx.fill();
                });

                if (currentZoom > 1.1 && isCentered && !this.isDiscovered && !isFinaleActive && gameStarted) {
                    triggerDiscovery(this);
                }

                if ((this.isDiscovered && currentZoom > 0.8) || isFinaleActive) {
                    const offset = this.type === 'normal' ? 40 : 85;
                    this.el.style.transform = `translate3d(${screenX}px, ${screenY + offset * currentZoom}px, 0) translateX(-50%)`;
                    if (!this.el.classList.contains('visible')) this.el.classList.add('visible');
                } else {
                    if (this.el.classList.contains('visible')) this.el.classList.remove('visible');
                }
            }
        }

        function triggerDiscovery(constellation) {
            constellation.isDiscovered = true;
            if (constellation.isHinted) constellation.isHinted = false;
            currentHintIndex = -1;
            lastDiscoveryTime = Date.now();
            
            if (starSFX.paused) {
                starSFX.currentTime = 0;
                starSFX.play().catch(() => {});
            } else {
                starSFX.currentTime = 0;
            }

            discoveredCount++;
            counterText.textContent = `${discoveredCount} / ${totalConstellations}`;

            if (discoveredCount === 1) {
                mysteryHint.classList.add('visible');
                setTimeout(() => { mysteryHint.classList.remove('visible'); }, 6000);
            }

            if (discoveredCount === totalConstellations) {
                setTimeout(startFinale, 1500);
            }
        }

        function calculateCFormation() {
            const radius = 4500; 
            const total = constellations.length;
            const startAngle = -2.2, endAngle = 2.2;

            constellations.forEach((c, i) => {
                const progress = i / (total - 1);
                const angle = startAngle + (endAngle - startAngle) * progress;
                const variance = (Math.random() - 0.5) * 150;
                const r = radius + variance;
                const finalAngle = Math.PI - angle; 
                c.targetFinaleX = Math.cos(finalAngle) * r;
                c.targetFinaleY = Math.sin(finalAngle) * r;
            });
        }

        function startFinale() {
            if (isFinaleActive) return;
            isFinaleActive = true;
            finaleStartTime = Date.now();
            calculateCFormation();

            hud.style.opacity = '0';
            mysteryHint.style.opacity = '0';
            document.getElementById('track-name').textContent = "Pense em mim";

            const fadeOut = setInterval(() => {
                if (bgMusic.volume > 0.05) bgMusic.volume -= 0.02;
                else { bgMusic.pause(); clearInterval(fadeOut); }
            }, 100);

            finaleMusic.play().catch(()=>{});
            let vol = 0;
            const fadeIn = setInterval(() => {
                if (vol < 0.75) { vol += 0.02; finaleMusic.volume = vol; }
                else clearInterval(fadeIn);
            }, 100);

            targetZoom = 0.08; 
            targetPanX = 0;
            targetPanY = 0;
        }

        function animate() {
            zoom += (targetZoom - zoom) * 0.04;
            panX += (targetPanX - panX) * 0.04;
            panY += (targetPanY - panY) * 0.04;

            ctx.fillStyle = '#050510';
            ctx.fillRect(0, 0, width, height);

            ctx.fillStyle = 'rgba(255, 255, 255, 0.12)';
            for(let i=0; i<300; i++) {
                const r1 = seededRandom(i);
                const r2 = seededRandom(i+1000);
                let bgX = (r1 * width + panX * 0.05 * zoom) % width;
                let bgY = (r2 * height + panY * 0.05 * zoom) % height;
                if (bgX < 0) bgX += width; if (bgY < 0) bgY += height;
                ctx.beginPath(); ctx.arc(bgX, bgY, 0.8, 0, Math.PI*2); ctx.fill();
            }

            if (isFinaleActive) {
                if (Math.random() < 0.15) {
                    shootingStars.push({
                        x: Math.random() * width, y: Math.random() * height * 0.4,
                        vx: 18 + Math.random() * 15, vy: 4 + Math.random() * 6,
                        len: 0, life: 1.0
                    });
                }
                
                for (let i = shootingStars.length - 1; i >= 0; i--) {
                    const s = shootingStars[i];
                    s.x += s.vx; s.y += s.vy; s.len = Math.min(s.len + 6, 250); s.life -= 0.008;
                    ctx.strokeStyle = `rgba(255, 255, 255, ${s.life})`;
                    ctx.lineWidth = 3.5;
                    ctx.beginPath(); ctx.moveTo(s.x, s.y);
                    ctx.lineTo(s.x - s.vx * (s.len/20), s.y - s.vy * (s.len/20));
                    ctx.stroke();
                    if (s.life <= 0) shootingStars.splice(i, 1);
                }

                constellations.forEach(c => {
                    c.worldX += (c.targetFinaleX - c.worldX) * 0.004;
                    c.worldY += (c.targetFinaleY - c.worldY) * 0.004;
                });

                if (Date.now() - finaleStartTime > 32000) {
                    document.getElementById('finale-overlay').classList.add('visible');
                }
            } else {
                if (gameStarted && Date.now() - lastDiscoveryTime > HINT_DELAY && currentHintIndex === -1) {
                    const undiscovered = constellations.filter(c => !c.isDiscovered);
                    if (undiscovered.length > 0) {
                        const randomC = undiscovered[Math.floor(Math.random() * undiscovered.length)];
                        randomC.isHinted = true;
                        currentHintIndex = constellations.indexOf(randomC);
                    }
                }
            }

            constellations.forEach(c => c.draw(ctx, zoom, panX, panY));
            requestAnimationFrame(animate);
        }

        function startGame() {
            gameStarted = true;
            bgMusic.play().catch(e => console.log(e));
            playIcon.style.display = 'none'; pauseIcon.style.display = 'block';
            equalizer.classList.remove('paused');
            introOverlay.classList.add('hidden');
            hud.classList.add('active');
            musicPlayer.classList.add('visible');
            targetZoom = 0.6;
        }

        function init() {
            resize();
            constellations.push(new Constellation(QUOTES[1], 0, 'sun'));
            constellations.push(new Constellation(QUOTES[7], 1, 'moon'));
            let idCounter = 2;
            QUOTES.forEach((q, i) => {
                if (i !== 1 && i !== 7) constellations.push(new Constellation(q, idCounter++));
            });
            totalConstellations = constellations.length;
            counterText.textContent = `0 / ${totalConstellations}`;
            animate();
            startBtn.addEventListener('click', startGame);
        }

        function resize() { width = window.innerWidth; height = window.innerHeight; canvas.width = width; canvas.height = height; }
        window.addEventListener('resize', resize);
        
        toggleMusicBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            const track = isFinaleActive ? finaleMusic : bgMusic;
            if (track.paused) {
                track.play();
                playIcon.style.display = 'none'; pauseIcon.style.display = 'block';
                equalizer.classList.remove('paused');
            } else {
                track.pause();
                playIcon.style.display = 'block'; pauseIcon.style.display = 'none';
                equalizer.classList.add('paused');
            }
        });

        window.addEventListener('keydown', (e) => {
            if (e.key.toLowerCase() === 'f') {
                startFinale();
            }
        });

        window.addEventListener('wheel', (e) => {
            if (isFinaleActive || !gameStarted) return;
            targetZoom -= e.deltaY * 0.001;
            targetZoom = Math.min(Math.max(targetZoom, 0.05), 4);
        }, { passive: true });

        window.addEventListener('mousedown', (e) => {
            if (isFinaleActive || !gameStarted) return;
            if (e.target.closest('.music-player')) return;
            isDragging = true; lastMouseX = e.clientX; lastMouseY = e.clientY;
            canvas.style.cursor = 'grabbing';
        });
        window.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            targetPanX += (e.clientX - lastMouseX) / zoom;
            targetPanY += (e.clientY - lastMouseY) / zoom;
            lastMouseX = e.clientX; lastMouseY = e.clientY;
            lastDiscoveryTime = Date.now();
        });
        window.addEventListener('mouseup', () => { isDragging = false; canvas.style.cursor = 'grab'; });

        canvas.addEventListener('touchstart', (e) => {
            if (isFinaleActive || !gameStarted) return;
            if (e.target.closest('.music-player')) return;
            if (e.touches.length === 1) { isDragging = true; lastMouseX = e.touches[0].clientX; lastMouseY = e.touches[0].clientY; }
            else if (e.touches.length === 2) {
                isDragging = false;
                const dx = e.touches[0].clientX - e.touches[1].clientX;
                const dy = e.touches[0].clientY - e.touches[1].clientY;
                initialPinchDistance = Math.sqrt(dx*dx + dy*dy); initialZoom = targetZoom;
            }
        }, { passive: false });
        canvas.addEventListener('touchmove', (e) => {
            if (isFinaleActive || !gameStarted) return;
            e.preventDefault();
            if (e.touches.length === 1 && isDragging) {
                const x = e.touches[0].clientX; const y = e.touches[0].clientY;
                targetPanX += (x - lastMouseX) / zoom; targetPanY += (y - lastMouseY) / zoom;
                lastMouseX = x; lastMouseY = y;
            } else if (e.touches.length === 2 && initialPinchDistance) {
                const dist = Math.sqrt(Math.pow(e.touches[0].clientX-e.touches[1].clientX,2) + Math.pow(e.touches[0].clientY-e.touches[1].clientY,2));
                targetZoom = Math.min(Math.max(initialZoom * (dist / initialPinchDistance), 0.05), 4);
            }
            lastDiscoveryTime = Date.now();
        }, { passive: false });
        window.addEventListener('touchend', () => { isDragging = false; initialPinchDistance = null; });

        init();

    